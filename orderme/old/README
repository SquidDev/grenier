Old implementation using Scapegoat tree with indirection optimization.
